---
title: 'Next.js Draft Mode: Complete Guide with Code Examples (2025)'
date: '2025-1-26'
lastmod: '2025-1-26'
tags: ['nextjs', 'draft mode', 'content management', 'preview mode', 'headless cms', 'isr', 'SSG', 'SSR']
draft: false
summary: 'Unlock seamless content previews with Next.js Draft Mode. This comprehensive guide walks you through implementing Draft Mode, integrating with headless CMS solutions, and optimizing your preview workflow with code examples.'
authors: ['default']
---

# Next.js Draft Mode: A Comprehensive Guide for Seamless Content Previews

In the world of modern web development, delivering a smooth and efficient content management workflow is paramount. Next.js, with its powerful features like Static Site Generation (SSG), Server-Side Rendering (SSR), and Incremental Static Regeneration (ISR), offers excellent performance. However, previewing content *before* it goes live can sometimes be tricky. That's where **Next.js Draft Mode** comes to the rescue.

This article delves deep into Next.js Draft Mode, providing a comprehensive guide to help you understand, implement, and optimize your content preview workflow. We'll cover:

*   What is Next.js Draft Mode and Why Use It?
*   Setting Up Draft Mode: Step-by-Step Implementation
*   Integrating with a Headless CMS (Example: Contentful)
*   Handling Dynamic Routes in Draft Mode
*   Security Considerations and Best Practices
*   Troubleshooting Common Issues
*   Advanced Techniques for Optimizing Your Draft Mode Workflow

## What is Next.js Draft Mode and Why Use It?

Next.js Draft Mode allows you to bypass statically generated content and fetch the latest, non-published version of your content directly from your CMS (Content Management System). This enables you to:

*   **Preview Content Before Publishing:** See exactly how your content will look on your live site *before* it's public, ensuring quality and accuracy.
*   **Streamline the Content Editing Process:** Empower content creators to confidently make changes, knowing they can preview their work in real-time.
*   **Enhance Collaboration:** Facilitate seamless collaboration between content creators, designers, and developers by providing a shared preview environment.
*   **Reduce Errors and Improve User Experience:** Catch potential errors and inconsistencies before they impact your live audience.

In essence, Draft Mode provides a dynamic window into your CMS data, bypassing the statically generated cache and allowing you to preview the "draft" version of your content.

## Setting Up Draft Mode: Step-by-Step Implementation

Here's a step-by-step guide to implementing Next.js Draft Mode:

**1. Create an API Route for Enabling Draft Mode:**

This API route will be responsible for setting the `Draft` cookie, effectively enabling Draft Mode. Create a file named `pages/api/draft.js` (or `.ts`) with the following code:

```javascript
// pages/api/draft.js

export default async function handler(req, res) {
  // Check for secret to protect route
  if (req.query.secret !== process.env.NEXT_PUBLIC_PREVIEW_SECRET) {
    return res.status(401).json({ message: 'Invalid secret' });
  }

  // Check if a slug is provided
  if (!req.query.slug) {
    return res.status(400).json({ message: 'Slug parameter is required' });
  }

  // Enable Draft Mode by setting the cookie
  res.setDraftMode({ enable: true });

  // Redirect to the path provided in the slug parameter
  // This example redirects to the post with the given slug
  res.redirect(`/posts/${req.query.slug}`);
}
```

**Explanation:**

*   **`process.env.NEXT_PUBLIC_PREVIEW_SECRET`**: This is a secret token you define in your `.env.local` file to protect your Draft Mode API route.  **Crucially, it needs to be prefixed with `NEXT_PUBLIC_` in a Next.js application for it to be accessible in the browser.**
*   **`req.query.slug`**:  This query parameter will contain the slug (or ID) of the content you want to preview.
*   **`res.setDraftMode({ enable: true })`**: This crucial line sets the `Draft` cookie in the user's browser, enabling Draft Mode.
*   **`res.redirect(`/posts/${req.query.slug}`)`**:  After enabling Draft Mode, the API route redirects the user to the specific page they want to preview.  Adjust this route according to your application's structure.

**2. Configure your `.env.local` file:**

Add the following to your `.env.local` file (or `.env.development.local` for development environments):

```
NEXT_PUBLIC_PREVIEW_SECRET=YOUR_SECRET_PREVIEW_TOKEN
```

**Important:** Replace `YOUR_SECRET_PREVIEW_TOKEN` with a strong, randomly generated secret.  **Never commit your `.env.local` file to your version control system.**

**3. Modify your page component to use `getStaticProps` or `getServerSideProps`:**

You'll need to adjust the `getStaticProps` or `getServerSideProps` function in the page you want to enable Draft Mode for.  Here's an example using `getStaticProps`:

```javascript
// pages/posts/[slug].js

import { getPostBySlug, getAllPosts } from '../../lib/api'; // Assuming you have these functions

export async function getStaticProps({ params, preview = false, previewData }) {
  const post = await getPostBySlug(params.slug, preview);

  if (!post) {
    return {
      notFound: true,
    };
  }

  return {
    props: {
      post,
      preview,
    },
    revalidate: 10, // Optional: Revalidate every 10 seconds
  };
}

export async function getStaticPaths() {
  const posts = getAllPosts(['slug']);

  return {
    paths: posts.map((post) => ({
      params: {
        slug: post.slug,
      },
    })),
    fallback: 'blocking', // or 'true' for immediate fallback
  };
}


export default function Post({ post, preview }) {
  return (
    <div>
      <h1>{post.title}</h1>
      {preview && (
        <p style={{ backgroundColor: 'yellow', padding: '10px' }}>
          You are in Draft Mode! <a href="/api/exit-draft">Exit Draft Mode</a>
        </p>
      )}
      <div dangerouslySetInnerHTML={{ __html: post.content }} />
    </div>
  );
}
```

**Explanation:**

*   **`preview = false` and `previewData` in `getStaticProps`**:  These are the crucial parameters that Next.js injects when Draft Mode is enabled.  `preview` will be `true` when Draft Mode is active. `previewData` can be used for storing session data.
*   **Passing `preview` to `getPostBySlug`**: This is where you tell your CMS data fetching function to retrieve the draft version of the content.  We'll cover this in more detail in the next section.
*   **Conditional Rendering Based on `preview`**:  The `Post` component now displays a message indicating that Draft Mode is active if `preview` is `true`. This is important for informing users that they are viewing a draft version.  It also includes a link to exit Draft Mode.
*   **`getStaticPaths`**:  Ensure your `getStaticPaths` function is correctly configured to generate all possible slugs for your posts.  The `fallback` option determines how Next.js handles requests for pages that haven't been statically generated yet.

**4. Create an API Route to Exit Draft Mode:**

To allow users to exit Draft Mode, create an API route to clear the `Draft` cookie.  Create a file named `pages/api/exit-draft.js` (or `.ts`) with the following code:

```javascript
// pages/api/exit-draft.js

export default async function handler(req, res) {
  // Exit Draft Mode by removing the cookie
  res.clearDraftMode();

  // Redirect to the homepage or any other page
  res.redirect('/');
}
```

**Explanation:**

*   **`res.clearDraftMode()`**: This clears the `Draft` cookie, effectively disabling Draft Mode.
*   **`res.redirect('/')`**:  This redirects the user to the homepage (or any other appropriate page) after exiting Draft Mode.

**5.  Update your data fetching logic to handle the `preview` flag:**

You need to modify your `getPostBySlug` function (or similar data fetching function) to fetch draft content when the `preview` flag is `true`. This will heavily depend on your CMS.  Here's a simplified example using a hypothetical CMS client:

```javascript
// lib/api.js (Example)

import cmsClient from './cms-client'; // Replace with your CMS client

export async function getPostBySlug(slug, preview = false) {
  const query = `
    query PostBySlug($slug: String!) {
      post(where: { slug: $slug }) {
        title
        slug
        content
      }
    }
  `;

  const variables = { slug };

  const data = await cmsClient.request(query, variables, {
    draft: preview, // Pass the preview flag to the CMS client
  });

  return data?.post;
}
```

**Explanation:**

*   **`cmsClient.request(query, variables, { draft: preview })`**: This assumes your CMS client accepts a `draft` option in the request, which tells it to fetch the draft version of the content.  This is where the specifics will vary depending on your CMS.  Consult your CMS documentation for the correct way to fetch draft content.

## Integrating with a Headless CMS (Example: Contentful)

Let's illustrate this with a concrete example using Contentful, a popular headless CMS.

**1. Install the Contentful SDK:**

```bash
npm install contentful
```

**2. Create a Contentful API client:**

```javascript
// lib/contentful.js

import { createClient } from 'contentful';

const space = process.env.CONTENTFUL_SPACE_ID;
const accessToken = process.env.CONTENTFUL_ACCESS_TOKEN;
const previewAccessToken = process.env.CONTENTFUL_PREVIEW_ACCESS_TOKEN;

const client = createClient({
  space: space,
  accessToken: accessToken,
});

const previewClient = createClient({
  space: space,
  accessToken: previewAccessToken,
  host: 'preview.contentful.com',
});

export const getClient = (preview) => (preview ? previewClient : client);

export async function fetchGraphQL(query, preview = false) {
  return await getClient(preview).graphql({ query });
}

export async function getAllPostsWithSlug() {
  const entries = await getClient().getEntries({
    content_type: 'blogPost',
    select: 'fields.slug',
  });
  return entries?.items;
}

export async function getPostAndMorePosts(slug, preview) {
  const entry = await getClient(preview).getEntries({
    content_type: 'blogPost',
    'fields.slug': slug,
    order: '-sys.createdAt',
  });

  return entry.items[0];
}

```

**Explanation:**

*   **`CONTENTFUL_SPACE_ID`, `CONTENTFUL_ACCESS_TOKEN`, `CONTENTFUL_PREVIEW_ACCESS_TOKEN`**: Store these in your `.env.local` file.  Obtain these from your Contentful account.
*   **`previewClient`**:  This is a separate Contentful client configured to connect to the Contentful Preview API (`preview.contentful.com`), using the `CONTENTFUL_PREVIEW_ACCESS_TOKEN`.
*   **`getClient(preview)`**: This function returns the appropriate Contentful client based on the `preview` flag.
*   **`getPostAndMorePosts(slug, preview)`**:  This function fetches the blog post from Contentful.  It uses `getClient(preview)` to determine whether to use the regular API or the Preview API.

**3. Update `getStaticProps` to use the Contentful client:**

```javascript
// pages/posts/[slug].js

import { getPostAndMorePosts, getAllPostsWithSlug } from '../../lib/contentful';
import { documentToReactComponents } from '@contentful/rich-text-react-renderer';
import { BLOCKS } from '@contentful/rich-text-types';


export async function getStaticProps({ params, preview = false }) {
  const post = await getPostAndMorePosts(params.slug, preview);

  if (!post) {
    return {
      notFound: true,
    };
  }

  return {
    props: {
      post,
      preview,
    },
    revalidate: 10,
  };
}

export async function getStaticPaths() {
  const allPosts = await getAllPostsWithSlug();
  return {
    paths: allPosts?.map((post) => `/posts/${post.fields.slug}`) || [],
    fallback: true,
  };
}

export default function Post({ post, preview }) {

  if (!post) {
    return <div>Loading...</div>; // or any loading indicator
  }

  return (
    <div>
      <h1>{post.fields.title}</h1>
      {preview && (
        <div style={{ backgroundColor: 'yellow', padding: '10px' }}>
          You are in Preview Mode!
          <a href="/api/exit-draft" style={{ marginLeft: '10px' }}>
            Exit Preview Mode
          </a>
        </div>
      )}
      <div>{documentToReactComponents(post.fields.content, {
        renderNode: {
          [BLOCKS.EMBEDDED_ASSET]: (node) => {
            const { title, description, file } = node.data.target.fields;
            const imageUrl = file['en-US'].url;
            const imageAlt = title['en-US'];
            return <img src={`https:${imageUrl}`} alt={imageAlt} title={description ? description['en-US'] : ''} style={{ maxWidth: '100%' }} />;
          }
        }
      })}</div>
    </div>
  );
}

```

**4. Construct the Preview URL:**

In your Contentful UI, when previewing an entry, you'll need to construct the correct URL to trigger Draft Mode. It will look something like this:

```
https://your-domain.com/api/draft?secret=YOUR_SECRET_PREVIEW_TOKEN&slug=your-post-slug
```

Replace `your-domain.com` with your actual domain (or `localhost:3000` during development) and `your-post-slug` with the actual slug of the content you want to preview.

Now, when you click on this URL in Contentful, it will:

1.  Call the `/api/draft` API route.
2.  The API route sets the `Draft` cookie and redirects you to `/posts/your-post-slug`.
3.  Next.js, seeing the `Draft` cookie, passes `preview: true` to `getStaticProps`.
4.  `getStaticProps` uses the Contentful Preview API to fetch the draft content.
5.  The `Post` component renders the draft content, displaying the "You are in Preview Mode!" message.

## Handling Dynamic Routes in Draft Mode

The example above already shows how to handle dynamic routes. The key is to pass the slug as a query parameter to the `/api/draft` route and then use it in the redirect:

```
https://your-domain.com/api/draft?secret=YOUR_SECRET_PREVIEW_TOKEN&slug=dynamic-route-parameter
```

## Security Considerations and Best Practices

*   **Protect your `/api/draft` route with a strong secret:** This is the most crucial security measure. Use a long, random string for `NEXT_PUBLIC_PREVIEW_SECRET` and store it securely. **Do not expose this secret in your client-side code.**
*   **Use `NEXT_PUBLIC_PREVIEW_SECRET` prefixed secrets:**  Ensure your secret is prefixed with `NEXT_PUBLIC_` to allow accessibility client-side.
*   **Don't commit your `.env.local` file:**  This file contains your secrets and should never be committed to version control.
*   **Use a separate Preview API token (if applicable):**  Some CMSs provide separate API tokens for preview environments.  Use these to further isolate your preview environment from your production environment. Contentful's `CONTENTFUL_PREVIEW_ACCESS_TOKEN` is a great example of this.
*   **Inform users that they are in Draft Mode:**  Clearly display a message indicating that the user is viewing a draft version of the content. This prevents confusion and ensures that users are aware of the content's status.
*   **Restrict access to the `/api/draft` route:**  Consider implementing additional authentication or authorization mechanisms to restrict access to the Draft Mode API route to authorized users only. This might involve checking user roles or permissions.

## Troubleshooting Common Issues

*   **"Invalid secret" error:**  Double-check that the `NEXT_PUBLIC_PREVIEW_SECRET` in your `.env.local` file matches the secret you're passing in the `secret` query parameter.  Also, make sure it's prefixed with `NEXT_PUBLIC_`.
*   **Content not updating in Draft Mode:**  Ensure that your CMS client is correctly configured to fetch draft content when the `preview` flag is `true`.  Also, check your CMS's caching settings to make sure it's not caching the draft content.
*   **Redirect loop:**  This can happen if the redirect in the `/api/draft` route is incorrect or if there's an issue with the Draft cookie.  Double-check the redirect URL and clear your browser's cookies to reset Draft Mode.
*   **`getStaticProps` not receiving `preview`:** Ensure you are exporting a `getStaticProps` (or `getServerSideProps`) function from your page component. Also, make sure you are including the `preview = false` argument in the function's parameter list.
*   **CORS issues:** If you are running your application locally, you might encounter CORS issues when making requests to your CMS. Configure your CMS to allow requests from your development origin (e.g., `http://localhost:3000`).

## Advanced Techniques for Optimizing Your Draft Mode Workflow

*   **Using a custom preview URL in your CMS:**  Most headless CMSs allow you to configure a custom preview URL. This allows you to directly link from the CMS editor to the preview page, making the workflow even more seamless.
*   **Implementing a dedicated preview environment:** For larger projects, consider setting up a dedicated preview environment with its own database and CMS instance. This provides a more isolated and stable preview experience.
*   **Integrating with a visual editor:**  Some visual editors provide seamless integration with Next.js Draft Mode, allowing you to edit and preview content directly within the editor.
*   **Leveraging `previewData` for Session Management:** The `previewData` object within `getStaticProps` or `getServerSideProps` allows you to store session-specific data while in Draft Mode.  This can be useful for persisting user preferences or other contextual information.

## Conclusion

Next.js Draft Mode is a powerful tool for streamlining your content preview workflow. By following this guide, you can implement Draft Mode in your Next.js application, integrate it with your headless CMS, and create a seamless preview experience for your content creators. Remember to prioritize security and follow best practices to ensure a robust and reliable Draft Mode implementation.  With Draft Mode, you can confidently publish high-quality content while minimizing errors and maximizing collaboration.