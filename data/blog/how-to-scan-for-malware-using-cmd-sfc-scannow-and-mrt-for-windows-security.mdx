---
title: 'How to Scan for Malware Using CMD: SFC /scannow and MRT for Windows Security'
date: '2024-10-26'
lastmod: '2024-10-26'
tags:
  [
    'malware removal',
    'cmd scan',
    'sfc /scannow',
    'mrt tool',
    'windows security',
    'virus scan',
    'command line scan',
    'system file checker',
    'microsoft removal tool',
  ]
draft: false
summary: 'Learn how to effectively scan your Windows system for malware using the Command Prompt (CMD) with the SFC /scannow command and the Microsoft Removal Tool (MRT). This comprehensive guide provides step-by-step instructions and best practices for maintaining a secure and stable Windows environment.'
authors: ['default']
---

# How to Scan for Malware Using CMD: SFC /scannow and MRT for Windows Security

In today's digital landscape, malware threats are constantly evolving, making it crucial to regularly scan your Windows system for infections. While dedicated antivirus software offers robust protection, built-in command-line tools like the System File Checker (SFC) and the Microsoft Removal Tool (MRT) provide valuable supplementary defenses. This guide will walk you through how to use these powerful tools via the Command Prompt (CMD) to scan for and remove malware, ensuring a more secure and stable Windows environment.

## Why Use CMD for Malware Scanning?

While graphical user interfaces (GUIs) are often preferred for their ease of use, using the Command Prompt (CMD) for malware scanning offers several advantages:

- **Direct Access to System Utilities:** CMD allows you to directly interact with system-level tools, bypassing potential software conflicts or GUI issues.
- **Bypassing Malware Interference:** Some malware attempts to disable or interfere with antivirus software. CMD access can provide a workaround to perform scans even when GUI applications are compromised.
- **Scripting and Automation:** CMD commands can be easily scripted and automated, enabling scheduled scans and proactive security measures.
- **Resource Efficiency:** CMD tools are generally lightweight and consume fewer system resources compared to full-fledged antivirus programs.

## Method 1: Using System File Checker (SFC) - `sfc /scannow`

The System File Checker (SFC) is a built-in Windows utility that scans for and restores corrupted or modified system files. While not specifically designed for malware detection, it can help identify and repair files that have been compromised by malware, thereby improving system stability and security.

**Steps to Use SFC /scannow:**

1.  **Open Command Prompt as Administrator:** Search for "cmd" in the Windows search bar, right-click on "Command Prompt," and select "Run as administrator." This is crucial because SFC requires administrative privileges to modify system files. You'll be prompted to confirm your choice.

2.  **Execute the SFC /scannow Command:** In the Command Prompt window, type the following command and press Enter:

    ```plaintext
    sfc /scannow
    ```

    This command initiates a system-wide scan that checks the integrity of all protected system files.

3.  **Wait for the Scan to Complete:** The scan can take a considerable amount of time, ranging from 15 minutes to an hour or more, depending on the size of your system drive and the speed of your computer. **Do not interrupt the scan.** The progress will be displayed in the Command Prompt window.

4.  **Review the Scan Results:** Once the scan is complete, you'll see a message indicating the outcome. There are several possible outcomes:

    - **"Windows Resource Protection did not find any integrity violations."** This means SFC didn't detect any corrupted or modified system files.

    - **"Windows Resource Protection found corrupt files and successfully repaired them."** This is the ideal outcome. SFC has identified and repaired damaged system files.

    - **"Windows Resource Protection found corrupt files but was unable to fix some of them."** This indicates that SFC encountered files it couldn't repair automatically. In this case, you can try the following:

      - **Restart your computer and run `sfc /scannow` again.** Sometimes a restart allows SFC to resolve issues that were previously unresolvable.
      - **Use the Deployment Image Servicing and Management (DISM) tool before running SFC.** DISM can repair the Windows image, providing SFC with a clean source for repairing files. To use DISM, run the following commands in an elevated Command Prompt, one at a time:

        ```plaintext
        DISM /Online /Cleanup-Image /CheckHealth
        DISM /Online /Cleanup-Image /ScanHealth
        DISM /Online /Cleanup-Image /RestoreHealth
        ```

        After running DISM, run `sfc /scannow` again.

      - **Manually replace the corrupted files:** This is a more advanced option that involves identifying the corrupted files from the SFC log file (located at `C:\Windows\Logs\CBS\CBS.log`) and replacing them with known-good copies from a Windows installation media or a known-good system.

**Explanation of the `sfc /scannow` command:**

- `sfc`: This is the command-line utility for the System File Checker.
- `/scannow`: This switch tells SFC to immediately scan all protected system files.

## Method 2: Using Microsoft Removal Tool (MRT) - `mrt`

The Microsoft Removal Tool (MRT), also known as the Malicious Software Removal Tool, is a free utility from Microsoft designed to scan for and remove specific prevalent malware families. It's updated monthly through Windows Update, making it a useful supplementary tool to your primary antivirus software.

**Steps to Use MRT:**

1.  **Open Command Prompt as Administrator:** As with SFC, MRT requires administrative privileges. Search for "cmd" in the Windows search bar, right-click on "Command Prompt," and select "Run as administrator."

2.  **Execute the `mrt` Command:** In the Command Prompt window, type the following command and press Enter:

    ```plaintext
    mrt
    ```

    This command launches the Microsoft Removal Tool. (Note: You _can_ also type `mrt` directly into the Run dialog box (Windows Key + R). This method does not require administrator privileges, but launching via CMD with admin rights is generally recommended.)

3.  **Follow the On-Screen Instructions:** The MRT has a simple graphical interface. You'll be presented with a welcome screen. Click "Next."

4.  **Choose a Scan Type:** MRT offers three scan types:

    - **Quick Scan:** This scan targets areas of the system most commonly infected by malware. It's the fastest option.
    - **Full Scan:** This scan checks all files on your system. It's the most comprehensive but also the slowest.
    - **Customized Scan:** This option allows you to select specific folders or drives to scan.

    Choose the scan type that best suits your needs. For a thorough check, a Full Scan is recommended, although it can take several hours.

5.  **Wait for the Scan to Complete:** The scan duration will vary depending on the scan type and the size of your system. The MRT will display the progress.

6.  **Review the Scan Results:** Once the scan is complete, the MRT will display a summary of the findings. If any malware is detected, it will attempt to remove it. Review the results carefully and take any necessary actions recommended by the tool.

**Important Considerations for Using MRT:**

- **MRT is not a replacement for a full-fledged antivirus solution.** It only targets specific malware families and provides limited protection against emerging threats. Use it as a supplement to your primary antivirus software.
- **MRT is updated monthly through Windows Update.** Make sure your Windows Updates are enabled to ensure you have the latest version of MRT with the most up-to-date malware definitions. To check for updates, go to Settings > Update & Security > Windows Update and click "Check for updates."
- **MRT does not provide real-time protection.** It only scans your system on demand.

## Best Practices for Malware Scanning

- **Run regular scans:** Schedule regular scans with both SFC and MRT (although MRT is usually triggered automatically through Windows Update).
- **Keep your antivirus software up to date:** Ensure your primary antivirus software is updated with the latest virus definitions.
- **Be cautious when opening email attachments or clicking on links from unknown sources:** These are common vectors for malware infection.
- **Download software only from trusted sources:** Avoid downloading software from unofficial websites or peer-to-peer networks.
- **Use a strong password and enable two-factor authentication:** Protect your accounts and data from unauthorized access.
- **Back up your important data regularly:** In the event of a malware infection, you can restore your data from a backup.

## Troubleshooting Common Issues

- **SFC /scannow fails to complete:** Try running the DISM tool as described above, or boot into Safe Mode and run SFC from there.
- **MRT doesn't detect any malware, but you suspect an infection:** Try running a scan with a different antivirus program. Consider a bootable antivirus rescue disk if the infection is severe.
- **Command Prompt doesn't open as administrator:** Ensure you're logged in with an account that has administrative privileges. If UAC (User Account Control) is enabled, you'll be prompted to confirm your choice.

## Conclusion

Scanning your Windows system for malware using CMD tools like `sfc /scannow` and `mrt` provides an additional layer of security and helps maintain a stable and reliable computing environment. While these tools are not replacements for comprehensive antivirus software, they offer valuable supplementary protection, especially when facing stubborn or persistent malware threats. By following the steps outlined in this guide and adopting best practices for online safety, you can significantly reduce your risk of malware infection. Regularly performing these scans, along with keeping your system and security software updated, is key to staying protected in the ever-evolving digital threat landscape.
