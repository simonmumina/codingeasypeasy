---
title: 'Hermes Engine Guide: Turbocharge Your Expo App on Android and iOS'
date: '2023-10-27'
lastmod: '2024-10-26'
tags: ['expo', 'hermes', 'react-native', 'android', 'ios', 'performance', 'optimization', 'javascript engine']
draft: false
summary: 'Learn how to configure the Hermes JavaScript engine in your Expo project for significantly improved performance on both Android and iOS platforms. This comprehensive guide provides step-by-step instructions and code examples to optimize your app for speed and efficiency.'
authors: ['default']
---

# Hermes Engine Guide: Turbocharge Your Expo App on Android and iOS

In the world of mobile app development, performance is paramount. Users expect fast loading times, smooth animations, and a responsive user interface. While React Native and Expo provide excellent tools for building cross-platform apps, optimizing the JavaScript engine is crucial for achieving peak performance. This is where **Hermes** comes in.

Hermes is an open-source JavaScript engine optimized for running React Native applications on Android and iOS.  Developed by Facebook (now Meta), it focuses on reducing app startup time, decreasing app size, and minimizing memory usage.  By default, Expo uses JavaScriptCore, which is fine but often struggles to compete in performance with Hermes, especially on lower-end devices.

This guide will walk you through the process of configuring Hermes in your Expo project, covering both Android and iOS platforms. We'll explore the benefits, potential challenges, and best practices to help you make the most of this powerful engine.

## Why Use Hermes?

Before we dive into the configuration process, let's understand why you should consider using Hermes:

*   **Improved Startup Time:** Hermes uses bytecode precompilation, which allows your app to start significantly faster.  This is critical for retaining users and providing a positive first impression.
*   **Reduced App Size:** The bytecode generated by Hermes is more compact than the JavaScript source code, leading to a smaller app size. This translates to faster download times and less storage space consumed on users' devices.
*   **Lower Memory Usage:** Hermes is designed to be memory-efficient, consuming less RAM than JavaScriptCore. This is particularly beneficial for older or lower-end devices with limited resources.
*   **Faster Execution:** Optimized for React Native, Hermes can execute JavaScript code more efficiently than JavaScriptCore, resulting in smoother animations and a more responsive user interface.

## Prerequisites

Before you begin, ensure you have the following:

*   **Node.js and npm/yarn:** You need a working Node.js environment with npm or yarn package manager installed.
*   **Expo CLI:** The Expo command-line interface is essential for managing and building your Expo project. Install it globally using: `npm install -g expo-cli` or `yarn global add expo-cli`.
*   **Expo Project:** You should have an existing Expo project. If not, create one using `expo init YourProjectName`.
*   **Android Studio (for Android):**  You'll need Android Studio installed and configured with an emulator or connected Android device.  Make sure you have the Android SDK set up correctly.
*   **Xcode (for iOS):** You'll need Xcode installed (available on macOS) for building and running your app on iOS simulators or devices.  You'll also need a valid Apple Developer account for code signing.
*   **expo-cli version > 4.0.0:**  The Expo CLI has undergone some significant changes in recent years so please make sure you're using the latest version.

## Step 1: Installing Dependencies and Configuring `app.json`

First, ensure that your project's dependencies are up to date. Run the following command in your project directory:

```bash
expo upgrade
```

This command updates your project's Expo SDK version and related dependencies to the latest compatible versions.

Next, modify your `app.json` (or `app.config.js/ts`) file to enable Hermes. Locate the `android` and `ios` sections and add the `jsEngine` property with the value `"hermes"`:

```json
{
  "expo": {
    // ... other configurations
    "android": {
      "jsEngine": "hermes"
    },
    "ios": {
      "jsEngine": "hermes"
    }
  }
}
```

If you're using `app.config.js` or `app.config.ts`, the equivalent would be:

```javascript
// app.config.js
export default {
  expo: {
    // ... other configurations
    android: {
      jsEngine: 'hermes',
    },
    ios: {
      jsEngine: 'hermes',
    },
  },
};
```

or

```typescript
// app.config.ts
import { ExpoConfig } from '@expo/config-types';

const config: ExpoConfig = {
  name: 'YourAppName',
  slug: 'YourAppName',
  version: '1.0.0',
  android: {
    jsEngine: 'hermes',
  },
  ios: {
    jsEngine: 'hermes',
  },
};

export default config;
```

**Important Considerations for `app.config.js/ts`:**

*   When using dynamic configuration (i.e., `app.config.js/ts`), be mindful of the environments you're targeting. You might want to enable Hermes only for production builds or specific environments to facilitate easier debugging with JavaScriptCore in development.  You can use environment variables to control this:

    ```javascript
    // app.config.js
    export default ({ config }) => {
      const hermesEnabled = process.env.HERMES_ENABLED === 'true';
      return {
        ...config,
        android: {
          ...config.android,
          jsEngine: hermesEnabled ? 'hermes' : undefined, // Use undefined to default to JavaScriptCore
        },
        ios: {
          ...config.ios,
          jsEngine: hermesEnabled ? 'hermes' : undefined,
        },
      };
    };
    ```

    Then, you can set the `HERMES_ENABLED` environment variable when building your app:

    ```bash
    HERMES_ENABLED=true expo build:android # or expo build:ios
    ```

## Step 2: Building Your App with Hermes

Now that you've enabled Hermes in your configuration, you need to rebuild your application.  Here's how to build for Android and iOS:

**Android:**

Run the following command in your project directory:

```bash
expo prebuild -p android
```

This command generates the native Android project files.  You'll likely be prompted to install or update necessary native packages. Follow the instructions provided by Expo.

Next, you need to build the APK or AAB file:

```bash
expo build:android
```

This command initiates the Android build process in the cloud.  You'll be prompted to configure the build settings, such as keystore credentials. Choose the appropriate options for your needs (generating a new keystore for initial builds is often the simplest).  Once the build is complete, you can download the APK or AAB file and install it on your Android device or upload it to the Google Play Store.

**iOS:**

Run the following command in your project directory:

```bash
expo prebuild -p ios
```

This command generates the native iOS project files.  Again, follow the prompts to install or update any native dependencies.

Next, build your iOS app:

```bash
expo build:ios
```

This command starts the iOS build process.  You will be prompted to provide your Apple Developer credentials and configure provisioning profiles. Choose the appropriate options based on your development setup (development build vs. distribution build).  Once the build is finished, you can download the `.ipa` file or submit it to the App Store through App Store Connect.

**Important Considerations for Building:**

*   **Clean Builds:** To ensure a clean build with Hermes, it's often a good practice to clear your project's cache and node modules before prebuilding. This can help resolve potential conflicts or inconsistencies. Run the following commands:

    ```bash
    expo start -c # Clear the Metro bundler cache
    rm -rf node_modules # Delete the node_modules directory
    npm install # Reinstall the node modules
    ```

*   **Android Gradle Plugin (AGP) Versions:**  Make sure your AGP version is compatible with your React Native and Expo versions.  Outdated AGP versions can sometimes cause build errors when using Hermes.  Expo CLI will usually guide you towards compatible AGP versions, but it's something to keep in mind if you encounter issues.

## Step 3: Verifying Hermes is Enabled

After building and installing your app, you can verify that Hermes is indeed running.

**Android:**

1.  **Connect your Android device to your computer via USB** and enable USB debugging in developer options.
2.  **Open the Chrome browser on your computer** and navigate to `chrome://inspect/#devices`.
3.  **Your app should appear under "Remote Target."** Click "inspect".
4.  **In the Chrome DevTools console, type `HermesInternal`.**  If Hermes is running, you'll see an object in the console with various Hermes-specific properties and methods. If it's not running, you'll likely get an error saying `HermesInternal` is not defined.

**iOS:**

1.  **Run your app on the iOS simulator or a connected iOS device.**
2.  **Open Safari on your Mac.**
3.  **Go to Develop > [Your Device Name] > [Your App Name].** If the Develop menu isn't visible, go to Safari > Preferences > Advanced and check "Show Develop menu in menu bar."
4.  **This will open the Safari Web Inspector.**
5.  **In the Safari Web Inspector console, type `HermesInternal`.**  Similar to Android, if Hermes is running, you'll see an object in the console; otherwise, you'll get an error.

**Alternative Verification Method (Both Android and iOS):**

You can also add a simple code snippet within your app to check for Hermes:

```javascript
import { useEffect } from 'react';
import { Platform, Alert } from 'react-native';

useEffect(() => {
  if (typeof HermesInternal === 'object') {
    Alert.alert('Hermes is running!');
  } else {
    if (Platform.OS === 'android' || Platform.OS === 'ios') {
      Alert.alert('Hermes is NOT running!');
    }
  }
}, []);
```

This code will display an alert when the component mounts, indicating whether Hermes is running.  Remember to remove this code in production builds.

## Troubleshooting

Here are some common issues you might encounter and their solutions:

*   **Build Errors:**

    *   **Dependency Conflicts:** Ensure that your project's dependencies are compatible with Hermes.  Expo's upgrade tool (`expo upgrade`) is helpful in resolving dependency conflicts.  Try cleaning your project's cache and node modules as described earlier.
    *   **Incorrect Configuration:** Double-check that you've correctly configured the `jsEngine` property in your `app.json` (or `app.config.js/ts`) file.
    *   **Android SDK Issues:** Verify that your Android SDK is properly installed and configured in Android Studio.  Make sure you have the necessary build tools and platform tools installed.
    *   **iOS Code Signing Issues:**  Ensure you have a valid Apple Developer account and that your provisioning profiles are correctly configured in Xcode.

*   **Hermes Not Running:**

    *   **Incorrect Build:** Make sure you've rebuilt your app *after* enabling Hermes in your `app.json`.  A clean build is crucial.
    *   **Debugger Attached:** Sometimes, if you have a debugger attached (e.g., Chrome DevTools connected to JavaScriptCore), it can interfere with Hermes. Disconnect the debugger and try running the app again.
    *   **Incorrect Verification:** Ensure you are using the correct verification method for your platform (Chrome DevTools for Android, Safari Web Inspector for iOS).
    *   **Conflicting Packages:** Some libraries might not be fully compatible with Hermes. Try disabling them temporarily to see if they are causing the issue.

*   **Performance Issues:**

    *   **Incorrect Configuration:** Double-check that Hermes is actually running (using the verification methods above).  It's easy to assume it's enabled when it's not.
    *   **Code Optimization:**  Hermes improves performance, but it doesn't magically solve all performance problems. You still need to write efficient JavaScript code and optimize your React Native components.  Use profiling tools to identify performance bottlenecks in your code.

## Tips for Optimization

*   **Use Hermes Profiling Tools:**  Hermes provides its own set of profiling tools that can help you identify performance bottlenecks within your JavaScript code.  Learn how to use these tools to gain deeper insights into your app's performance.
*   **Optimize Images:** Large, unoptimized images can significantly impact app performance. Use tools to compress and optimize your images before including them in your app.
*   **Lazy Load Components:**  Load components only when they are needed to reduce initial loading time.  React's `lazy` and `Suspense` APIs can be helpful for implementing lazy loading.
*   **Reduce Re-renders:**  Minimize unnecessary re-renders in your React Native components.  Use `React.memo` and `useMemo` hooks to prevent components from re-rendering when their props haven't changed.
*   **Use FlatList or SectionList:**  For rendering large lists of data, use `FlatList` or `SectionList` instead of `ScrollView`. These components virtualize the list, rendering only the visible items and improving performance.
*   **JavaScript Bundler Configuration:** Review your Metro bundler configuration (metro.config.js) and ensure that it's optimized for production builds. This includes enabling code minification and dead code elimination.

## Conclusion

Configuring Hermes in your Expo project is a relatively straightforward process that can yield significant performance benefits. By following the steps outlined in this guide, you can optimize your app for speed, efficiency, and a better user experience on both Android and iOS platforms. Remember to thoroughly test your app after enabling Hermes to ensure compatibility and identify any potential issues.  Regularly profile your app's performance and continue to optimize your code to achieve the best possible results. Good luck!